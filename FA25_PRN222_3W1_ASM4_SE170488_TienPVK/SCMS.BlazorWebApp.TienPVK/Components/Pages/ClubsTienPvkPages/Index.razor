@page "/clubstienpvks"
@using Microsoft.AspNetCore.Components.QuickGrid
@using Microsoft.EntityFrameworkCore
@using SCMS.Domain.TienPVK.Models
@using SCMS.Repository.TienPVK.DBContext
@using SCMS.Service.TienPVK
@* @implements IAsyncDisposable *@
@inject AppServiceProvider _service;

<PageTitle>Clubs</PageTitle>

<h1>Clubs</h1>

<p>
    <a href="clubstienpvks/create">Create New</a>
</p>

<QuickGrid Class="table" Items="sessions" TGridItem="ClubsTienPvk">
    <PropertyColumn Property="clubstienpvk => clubstienpvk.ClubCode" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.ClubName" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.CategoryIdtienPvk" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.Description" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.FoundedDate" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.Email" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.Phone" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.Address" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.ManagerUserId" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.MemberLimit" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.IsOpenToJoin" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.RequiresApproval" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.Status" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.CreatedAt" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.CreatedBy" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.ModifiedBy" />
    <PropertyColumn Property="clubstienpvk => clubstienpvk.ModifiedAt" />

    <TemplateColumn Context="clubstienpvk">
        <a href="@($"clubstienpvks/edit?clubidtienpvk={clubstienpvk.ClubIdtienPvk}")">Edit</a> |
        <a href="@($"clubstienpvks/details?clubidtienpvk={clubstienpvk.ClubIdtienPvk}")">Details</a> |
        <a href="@($"clubstienpvks/delete?clubidtienpvk={clubstienpvk.ClubIdtienPvk}")">Delete</a>
    </TemplateColumn>
</QuickGrid>

@code {
    private IQueryable<ClubsTienPvk> sessions
        = Enumerable.Empty<ClubsTienPvk>().AsQueryable();

    private bool isLoading = true;
    private string? loadError;

    protected override async Task OnInitializedAsync()
    {
        await LoadClubs();
    }

    private async Task LoadClubs()
    {
        var data = await _service.ClubService.GetAllAsync();
        sessions = data.AsQueryable();
    }

    // public async ValueTask DisposeAsync() => await sessions.DisposeAsync();
}
